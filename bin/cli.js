#!/usr/bin/env node
"use strict";var o=require("commander"),r=require("path"),e=require("fs"),n=require("child_process");o.program.option("-w, --workflow <type>","relative path to workflow file"),o.program.option("-n, --name <type>","workflow name to compile in the file"),o.program.parse(process.argv);var l=o.program.opts();if(l.workflow&&l.name){e.rmSync(r.resolve("tsconfig.workflow_build.json"),{force:!0,recursive:!0}),e.rmSync(r.resolve("dump_workflow_script.ts"),{force:!0,recursive:!0}),e.rmSync(r.resolve("./_workflow_compile_"),{force:!0,recursive:!0});var s=l.workflow.substring(0,l.workflow.lastIndexOf(".")),c='\nimport { buildJsxWorkflow } from "taskflow-react"\nimport { dumpWorkflow } from "taskflow-react"\nimport {'.concat(l.name,'} from "').concat(s,'"\nconst workflow = buildJsxWorkflow(').concat(l.name,")\nexport const dumpWorkflowText = dumpWorkflow(workflow)\n");e.writeFileSync(r.resolve("./".concat("tsconfig.workflow_build.json")),'{\n    "compilerOptions": {\n      "target": "es5",\n      "module": "CommonJS",\n      "outDir": "_workflow_compile_",\n      "lib": ["ESNext", "dom"],\n      "allowJs": false,\n      "sourceMap": true,\n      "experimentalDecorators": false,\n      "noUnusedLocals": false,\n      "esModuleInterop": true,\n      "moduleResolution": "node",\n      "types": [\n        "node",\n        "jest",\n      ],\n      "jsx": "react-jsx"\n    }\n  }\n'),e.writeFileSync(r.resolve("./".concat("dump_workflow_script.ts")),c),n.execSync("tsc --project ".concat("tsconfig.workflow_build.json"));var t=require("../_workflow_compile_/dump_workflow_script");console.log("[32m",t.dumpWorkflowText),console.log("[37m"),e.rmSync(r.resolve("tsconfig.workflow_build.json"),{force:!0,recursive:!0}),e.rmSync(r.resolve("dump_workflow_script.ts"),{force:!0,recursive:!0}),e.rmSync(r.resolve("./_workflow_compile_"),{force:!0,recursive:!0})}
